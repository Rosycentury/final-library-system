<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€¾æœŸè®°å½•ç®¡ç† - å›¾ä¹¦é¦†ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        .overdue-stats {
            display: flex;
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            flex: 1;
        }
        
        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #e74c3c;
            margin: 10px 0;
        }
        
        .stat-label {
            color: #666;
            font-size: 14px;
        }
        
        .overdue-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .overdue-table th, .overdue-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
            text-align: left;
        }
        
        .overdue-table th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        
        .overdue-days {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .action-buttons {
            display: flex;
            gap: 5px;
        }
    </style>
</head>
<body>
    <div class="navbar">
        <div class="navbar-container">
            <a href="/" class="logo">ğŸ“š å›¾ä¹¦é¦†ç®¡ç†ç³»ç»Ÿ</a>
            <div class="nav-links">
                <a href="/admin/dashboard">è¿”å›ä»ªè¡¨æ¿</a>
                <a href="/logout">é€€å‡ºç™»å½•</a>
            </div>
        </div>
    </div>
    
    <div class="container">
        <h1>é€¾æœŸè®°å½•ç®¡ç†</h1>
        
        <div class="overdue-stats">
            <div class="stat-card">
                <div class="stat-number" th:text="${overdueCount}">0</div>
                <div class="stat-label">é€¾æœŸè®°å½•æ€»æ•°</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-number" th:text="${overdue7Days}">0</div>
                <div class="stat-label">è¶…æ—¶7å¤©ä»¥ä¸Š</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-number" th:text="${overdue30Days}">0</div>
                <div class="stat-label">è¶…æ—¶30å¤©ä»¥ä¸Š</div>
            </div>
        </div>
        
        <div th:if="${overdueRecords.empty}">
            <p style="text-align: center; padding: 40px; color: #666;">ğŸ‰ ç›®å‰æ²¡æœ‰é€¾æœŸè®°å½•ï¼</p>
        </div>
        
        <div th:unless="${overdueRecords.empty}">
            <table class="overdue-table">
                <thead>
                    <tr>
                        <th>è¯»è€…</th>
                        <th>å›¾ä¹¦</th>
                        <th>å€Ÿé˜…æ—¥æœŸ</th>
                        <th>åº”è¿˜æ—¥æœŸ</th>
                        <th>é€¾æœŸå¤©æ•°</th>
                        <th>è”ç³»æ–¹å¼</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="record : ${overdueRecords}">
                        <td th:text="${record.username}">è¯»è€…</td>
                        <td th:text="${record.bookTitle}">å›¾ä¹¦</td>
                        <td th:text="${#temporals.format(record.borrowDate, 'yyyy-MM-dd')}">å€Ÿé˜…æ—¥æœŸ</td>
                        <td th:text="${#temporals.format(record.dueDate, 'yyyy-MM-dd')}">åº”è¿˜æ—¥æœŸ</td>
                        <td class="overdue-days">
                            <span th:text="${overdueDaysMap.get(record.id)}">0</span> å¤©
                        </td>
                        <td>
                            <span th:text="${'ğŸ“§ ' + record.username + '@email.com'}">é‚®ç®±</span>
                        </td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-primary" onclick="sendReminder('[[${record.id}]]')" style="padding: 5px 10px; font-size: 12px;">å‘é€æé†’</button>
                                <button class="btn btn-secondary" onclick="contactUser('[[${record.username}]]')" style="padding: 5px 10px; font-size: 12px;">è”ç³»è¯»è€…</button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            
            <div style="margin-top: 20px; text-align: center;">
                <button class="btn btn-primary" onclick="sendAllReminders()">æ‰¹é‡å‘é€æé†’</button>
                <button class="btn btn-secondary">å¯¼å‡ºé€¾æœŸè®°å½•</button>
            </div>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <p>Â© 2025 å›¾ä¹¦é¦†ç®¡ç†ç³»ç»Ÿ | é€¾æœŸè®°å½•ç®¡ç†</p>
        </div>
    </footer>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('é€¾æœŸç®¡ç†é¡µé¢åŠ è½½å®Œæˆ');
        });
        
        function sendReminder(recordId) {
            alert('æé†’é‚®ä»¶å·²å‘é€ç»™è®°å½•IDï¼š' + recordId);
        }
        
        function contactUser(username) {
            alert('è”ç³»è¯»è€…ï¼š' + username);
        }
        
        function sendAllReminders() {
            if (confirm('ç¡®å®šè¦ç»™æ‰€æœ‰é€¾æœŸè®°å½•å‘é€æé†’å—ï¼Ÿ')) {
                alert('æ‰¹é‡æé†’é‚®ä»¶å·²å‘é€ï¼');
            }
        }
    </script>
</body>
</html>